(this.webpackJsonp=this.webpackJsonp||[]).push([[6],{"./node_modules/file-saver/dist/FileSaver.min.js":function(e,t,n){(function(n){var o,r,a;r=[],void 0===(a="function"==typeof(o=function(){"use strict";function t(e,t,n){var o=new XMLHttpRequest;o.open("GET",e),o.responseType="blob",o.onload=function(){s(o.response,t,n)},o.onerror=function(){console.error("could not download file")},o.send()}function o(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function r(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n&&n.global===n?n:void 0,i=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(e,n,i){var s=a.URL||a.webkitURL,l=document.createElement("a");n=n||e.name||"download",l.download=n,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?r(l):o(l.href)?t(e,n,i):r(l,l.target="_blank")):(l.href=s.createObjectURL(e),setTimeout((function(){s.revokeObjectURL(l.href)}),4e4),setTimeout((function(){r(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,n,a){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,a),n);else if(o(e))t(e,n,a);else{var i=document.createElement("a");i.href=e,i.target="_blank",setTimeout((function(){r(i)}))}}:function(e,n,o,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof e)return t(e,n,o);var s="application/octet-stream"===e.type,l=/constructor/i.test(a.HTMLElement)||a.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||s&&l||i)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=e:location=e,r=null},u.readAsDataURL(e)}else{var d=a.URL||a.webkitURL,f=d.createObjectURL(e);r?r.location=f:location.href=f,r=null,setTimeout((function(){d.revokeObjectURL(f)}),4e4)}});a.saveAs=s.saveAs=s,e.exports=s})?o.apply(t,r):o)||(e.exports=a)}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./node_modules/worker-loader/dist/cjs.js!./src/engine/encoders/mp3.worker.js":function(e,t,n){e.exports=function(){return new Worker(n.p+"881e18de7b88e00dcff1.worker.js")}},"./node_modules/worker-loader/dist/cjs.js!./src/engine/encoders/wav.worker.js":function(e,t,n){e.exports=function(){return new Worker(n.p+"673b6f265626e5264686.worker.js")}},"./src/components/ExportAudioDialog.js":function(e,t,n){"use strict";n.r(t);var o=n("./node_modules/react/index.js"),r=n.n(o),a=n("./node_modules/unistore/react.js"),i=n("./src/store/index.js"),s=n("./src/engine/AudioDataEngine.js"),l=n("./node_modules/worker-loader/dist/cjs.js!./src/engine/encoders/wav.worker.js"),c=n.n(l),u=0,d=null,f=new WeakMap,m=new Map;function p(){m.size||(d.terminate(),d=null)}function g(e){var t=e.data,n=t.requestId,o=t.blob,r=m.get(n);m.delete(n),r(o),setTimeout(p,5e3)}var h=n("./node_modules/worker-loader/dist/cjs.js!./src/engine/encoders/mp3.worker.js"),b=n.n(h),v=0,w=null,y=new Map;function j(){y.size||(w.terminate(),w=null)}function x(e){var t=e.data,n=t.requestId,o=t.error,r=t.blob,a=y.get(n);if(o)return a.reject(o),y.delete(n),void setTimeout(j,5e3);var i=r?1:e.data.progress;i&&a.onProgress&&a.onProgress(i),r&&(a.resolve(r),y.delete(n),setTimeout(j,5e3))}var E=n("./node_modules/event-emitter/index.js"),A=n.n(E),R=n("./node_modules/event-emitter/all-off.js"),C=n.n(R),k=n("./src/util/loadRequirements.js"),T=n("./src/util/normalizeSpaces.js"),O=(n("./src/engine/speech-voices.js"),n("./src/util/analytics.js")),P=n("./src/images/two-tone-logo-32.png"),_=n.n(P),M={wav:function(e){var t=f.get(e);if(!t){var n=u++;d||((d=new c.a).onmessage=g),t=new Promise((function(t){m.set(n,t);for(var o=[],r=0;r<e.numberOfChannels;r++)o.push(e.getChannelData(r));var a=o.map((function(e){return e.buffer}));d.postMessage({arrays:o,sampleRate:e.sampleRate,requestId:n},a)})),f.set(e,t)}return t},mp3:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:128,o=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,a=v++;return w||((w=new b.a).onmessage=x),new Promise((function(i,s){y.set(a,{resolve:i,reject:s,onProgress:o});for(var l=[],c=0;c<e.numberOfChannels;c++)l.push(e.getChannelData(c));var u=l.map((function(e){return e.buffer}));w.postMessage({arrays:l,sampleRate:e.sampleRate,bitRate:n,meta:t,requestId:a},u),r&&r.addEventListener("abort",(function(){y.has(a)&&w&&w.postMessage({requestId:a,command:"abort"})}))}))}},S=function(){return fetch(_.a).then((function(e){return e.arrayBuffer()}))};function L(e){var t=k.b.AudioContext.OfflineAudioContext;try{return new t(e)}catch(e){}return new t(e.numberOfChannels,e.length,e.sampleRate)}function F(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=n.sampleRate||44100,r=(n.format||"mp3").toLowerCase(),a=n.bitRate||128,i=null,l=1,c=0,u=0,d=null;function f(t){Object(O.b)({sampleRate:o,exportFormat:r,bitRate:a,duration:Math.round(1e3*e.duration)},t)}this.start=function(){return new Promise((function(n,m){var p,g,h,b,v,w,y,j,x,E;if(i)return m(new Error("Already rendering audio for export"));function A(){return i.update(),i.on("timeupdate",(function(){u=Math.max(u,.4*i.currentTime/g),t.emit("progress")})),f("save"),Promise.resolve(i.play()).then((function(o){try{return Promise.resolve(h.startRendering()).then((function(o){try{return b=o,i?(i.destroy(),i=null,c!==p?n(null):(d=window.AbortController&&new AbortController,v=d&&d.signal,(w=(e.tracks||[]).map((function(t){var n=t.intensityField,o=e.data.fields[n];return o&&"- "+o.name||""}))).push("","Generated by ".concat("TwoTone"," (build ").concat("2021-02-01T19:06:47.000Z 7240e68",")")),y=w.join("\n"),Promise.resolve(S()).then((function(o){try{return j={TIT2:e.dataSource.metadata.title,TENC:"TwoTone",ISFT:"TwoTone",COMM:{description:"Comment",text:y},APIC:{type:3,data:o,description:"TwoTone",useUnicodeEncoding:!1}},x=M[r],Promise.resolve(x(b,j,a,(function(e){u=Math.max(u,.4+.6*e),t.emit("progress")}),v)).then((function(e){try{return E=e,c!==p?n(null):(d=null,f("complete"),c=0,u=1,t.emit("finish",E),n(E))}catch(e){return m(e)}}),m)}catch(e){return m(e)}}),m))):n(null)}catch(e){return m(e)}}),m)}catch(e){return m(e)}}),m)}return p=l++,c=p,u=0,g=e.duration,h=L({numberOfChannels:2,length:o*g,sampleRate:o}),(i=new s.a(h)).data=e.data,i.tracks=e.tracks||[],i.rowDuration=e.rowDuration,i.speechTitleEnabled=e.speechTitleEnabled,i.speechTitle=Object(T.a)(e.speechTitleEnabled&&e.speechTitle),A.call(this)}))},this.abort=function(){i&&i.destroy(),i=null,d&&d.abort(),d=null,f("abort");var e=c;c=0,e&&t.emit("abort")},this.destroy=function(){t.abort(),C()(t)},A()(this),Object.defineProperties(this,{processing:{get:function(){return!!i}},progress:{get:function(){return u}}})}var B=n("./src/util/setStateFromEvent.js"),D=n("./node_modules/file-saver/dist/FileSaver.min.js"),U=n("./node_modules/@material-ui/core/styles/withStyles.js"),I=n.n(U),N=n("./node_modules/@material-ui/core/Dialog/index.js"),W=n.n(N),Y=n("./node_modules/@material-ui/core/DialogTitle/index.js"),H=n.n(Y),q=n("./node_modules/@material-ui/core/DialogActions/index.js"),z=n.n(q),V=n("./node_modules/@material-ui/core/DialogContent/index.js"),Q=n.n(V),G=n("./node_modules/@material-ui/core/DialogContentText/index.js"),J=n.n(G),K=n("./node_modules/@material-ui/core/FormControl/index.js"),X=n.n(K),Z=n("./node_modules/@material-ui/core/Select/index.js"),$=n.n(Z),ee=n("./node_modules/@material-ui/core/Input/index.js"),te=n.n(ee),ne=n("./node_modules/@material-ui/core/InputLabel/index.js"),oe=n.n(ne),re=n("./node_modules/@material-ui/core/MenuItem/index.js"),ae=n.n(re),ie=n("./node_modules/@material-ui/core/Button/index.js"),se=n.n(ie),le=n("./node_modules/@material-ui/core/LinearProgress/index.js"),ce=n.n(le);function ue(e){return(ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function de(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fe(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function me(e,t){return(me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=be(e);if(t){var r=be(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return ge(this,n)}}function ge(e,t){return!t||"object"!==ue(t)&&"function"!=typeof t?he(e):t}function he(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function be(e){return(be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ve(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var we=!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&"download"in document.createElementNS("http://www.w3.org/1999/xhtml","a"),ye=[64,128,192,320],je=new Intl.NumberFormat(navigator.language,{minimumFractionDigits:0,maximumFractionDigits:0}),xe=new Intl.NumberFormat(navigator.language,{minimumFractionDigits:0,maximumFractionDigits:1});var Ee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&me(e,t)}(i,e);var t,n,o,a=pe(i);function i(){var e;de(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return ve(he(e=a.call.apply(a,[this].concat(n))),"state",{exporting:!1,format:"mp3",bitRate:128,progress:0,error:"",downloadURL:""}),ve(he(e),"playBlockClaim",Symbol()),ve(he(e),"engine",null),ve(he(e),"onProgress",(function(){var t=e.engine&&e.engine.progress||0;e.setState({progress:t})})),ve(he(e),"exportAudio",(function(){return new Promise((function(t,n){var o,r,a,i,s,l,c;e.props.blockPlayback(e.playBlockClaim),o=e.state,r=o.format,a=o.bitRate,i=new F(e.props,{format:r,bitRate:a,sampleRate:44100}),e.engine=i,e.props.setConfig({format:r,bitRate:a}),i.on("progress",e.onProgress),e.setState({error:"",exporting:!0,progress:0,downloadURL:""}),s="",l=null;var u=function(){try{return i.destroy(),e.finish(s),l&&(!s&&we?(Object(D.saveAs)(l,(e.props.dataSource.metadata.title||"data")+"."+r),e.props.onClose&&e.props.onClose()):(c=URL.createObjectURL(l),e.setState({downloadURL:c}))),t()}catch(e){return n(e)}},d=function(e){try{return console.error("Error exporting audio",e,e.stack),s="Failed to export audio",u()}catch(e){return n(e)}};try{return Promise.resolve(i.start()).then((function(e){try{return l=e,u()}catch(e){return d(e)}}),d)}catch(e){d(e)}}))})),ve(he(e),"finish",(function(t){e.engine&&e.engine.destroy(),e.engine=null,e.props.releasePlayback(e.playBlockClaim),e.setState({error:"string"==typeof t&&t?t:"",progress:0,exporting:!1})})),ve(he(e),"cancel",(function(){e.state.exporting?e.finish():e.props.onClose&&e.props.onClose()})),ve(he(e),"handleChangeValue",Object(B.a)(he(e))),e}return t=i,(n=[{key:"componentDidMount",value:function(){var e=this.props.config,t=e.bitRate,n=e.format;t&&n&&this.setState({bitRate:t,format:n})}},{key:"componentWillUnmount",value:function(){this.finish()}},{key:"render",value:function(){var e,t=this.props,n=t.classes,o=t.duration,a=t.open,i=this.state,s=i.exporting,l=i.error,c=i.progress,u=i.format,d=i.bitRate,f=i.downloadURL,m="wav"===u?176400*o:o*d*1024/8,p=s?r.a.createElement("div",null,r.a.createElement(J.a,{id:"export-audio-dialog-description"},"Exporting project to audio file"),r.a.createElement(ce.a,{variant:"determinate",value:100*c})):r.a.createElement("div",null,r.a.createElement(J.a,{id:"export-audio-dialog-description"},"Export project to audio file"),l&&r.a.createElement(J.a,{variant:"subtitle1",color:"error"},l),r.a.createElement("div",null,r.a.createElement(X.a,{className:n.formControl},r.a.createElement(oe.a,{htmlFor:"export-format"},"Format"),r.a.createElement($.a,{value:u,onChange:this.handleChangeValue,name:"format",input:r.a.createElement(te.a,{id:"export-format"})},r.a.createElement(ae.a,{value:"mp3"},"MP3"),r.a.createElement(ae.a,{value:"wav"},"Waveform (PCM)"))),"wav"!==u&&r.a.createElement(X.a,{className:n.formControl},r.a.createElement(oe.a,{htmlFor:"export-bit-rate"},"Bit Rate"),r.a.createElement($.a,{value:d,onChange:this.handleChangeValue,name:"bitRate",input:r.a.createElement(te.a,{id:"export-bit-rate"})},ye.map((function(e){return r.a.createElement(ae.a,{value:e,key:e},e," kbps")}))))),r.a.createElement(J.a,{id:"export-audio-file-size"},"Estimated file size: ",(e=m)<1e3?je.format(e)+"B":e<1e6?je.format(e/1e3)+"KB":xe.format(e/1e6)+"MB"),f?r.a.createElement(J.a,{id:"export-download"},"Export Complete",r.a.createElement(se.a,{key:"download",color:"secondary",target:"_blank",variant:"contained",rel:"noopener noreferrer",href:f},"Open")):null);return r.a.createElement(W.a,{open:!1!==a,onClose:this.close,keepMounted:!0,disableBackdropClick:s,classes:{paper:n.dialog},"aria-labelledby":"export-audio-dialog-title","aria-describedby":"export-audio-dialog-description"},r.a.createElement(H.a,{id:"export-audio-dialog-title"},"Export Audio"),r.a.createElement(Q.a,null,p),r.a.createElement(z.a,null,r.a.createElement(se.a,{onClick:this.cancel,color:"secondary"},"Cancel"),r.a.createElement(se.a,{onClick:this.exportAudio,color:"secondary",autoFocus:!0,disabled:s},"Export")))}}])&&fe(t.prototype,n),o&&fe(t,o),i}(r.a.Component),Ae=I()((function(e){return{dialog:{minWidth:"50%",maxWidth:"80%",minHeight:"40%",maxHeight:"80%"},formControl:{margin:e.spacing.unit,"&:first-child":{marginLeft:0}}}}))(Object(a.connect)(["data","tracks","config","rowDuration","duration","dataSource","speechTitle","speechTitleEnabled","speechLanguage","speechGender","speechVoiceId"],i.a)(Ee));t.default=Ae},"./src/images/two-tone-logo-32.png":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAA2klEQVRYw2P8WsPwn4ECwNX8/xMF2j+yMFAO+CjRzMQwwAB7CLCwMzCJ6RDW/f8vw/8vL4iyiJFHgngHMEnoM3CknyRs/9dXDN87xIlLK01/GRgYmQZfFIw6YNQB2LPhr28M/56dw6Kag4FJTAu/j2TMGBgYmbFlROId8O/VFYYf040xxJmVnRnYE/bgdQB7/E4GRg6B0TQw6oBRB4w6YNQBow4YdcCoAyhsEeEAfx8fZ/gxzQip5fKHgbPiJWq7h52fdg5g+PWN4d/z86gWcouNoCjAASjqngMAgMouH5LEYxUAAAAASUVORK5CYII="}}]);
//# sourceMappingURL=index-79e543d16c5299f36c93.js.map